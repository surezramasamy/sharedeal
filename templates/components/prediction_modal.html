<!-- templates/components/prediction_modal.html -->
 <meta name="viewport" content="width=device-width, initial-scale=1">
<div class="modal fade" id="predictModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title">ðŸ”® Price Forecast - {{ data.ticker }}</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p class="mb-3"><strong>Latest Close Price:</strong> â‚¹{{ data.current_price }}</p>

        <!-- New: Forecast Chart -->
        <h6 class="mb-3">Price Forecast Chart (LSTM Model)</h6>
        <div class="text-center mb-4">
          <img src="data:image/png;base64,{{ data.chart_base64 }}" alt="Forecast Chart" class="img-fluid rounded shadow-sm" style="max-height: 400px;">
        </div>

        <!-- Forecast Table -->
        <h6>Next 6 Trading Days Prediction</h6>
        <table class="table table-sm table-bordered table-striped">
          <thead class="table-light">
            <tr>
              <th>Date</th>
              <th>Predicted Price (â‚¹)</th>
              <th>Change (â‚¹)</th>
              <th>Change (%)</th>
            </tr>
          </thead>
          <tbody>
            {% for item in data.forecast %}
            <tr {% if loop.index == 1 %}class="table-info fw-bold"{% endif %}>
              <td>{{ item.date }} {% if loop.index == 1 %}(Predicted Today){% endif %}</td>
              <td>â‚¹{{ item.price }}</td>
              <td>{% if item.change >= 0 %}+{% endif %}{{ item.change }}</td>
              <td>{% if item.change_pct >= 0 %}+{% endif %}{{ item.change_pct }}%</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <small class="text-muted d-block mt-3">
          * Prediction based on LSTM using RSI, MACD, CCI, Volume, PE, etc.<br>
          Historical data (blue) + Forecast (orange dots)
        </small>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script>
  // Auto-show modal when loaded
  var predictModal = new bootstrap.Modal(document.getElementById('predictModal'));
  predictModal.show();

  // Clear modal content after close (fixes "not going back" feel)
  document.getElementById('predictModal').addEventListener('hidden.bs.modal', function () {
    document.getElementById('modalContainer').innerHTML = '';
  });
</script>